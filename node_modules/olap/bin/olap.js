#!/usr/bin/env node
'use strict';

const OLAPValidator = require('../lib/OLAPValidator');
const program = require('commander');
const fs = require('fs')
const path = require('path');

program
    .version('0.0.5');

program
    .command('validator')
    .alias('v')
    .description('command to run olap validator (ex.: node olap validator --settings settings.json)')
    .option('-s, --settings <settings>', 'settings JSON file')
    .option('-c, --cube <cube>', 'filter a specific cube in the settings file')
    .action((options) => {

        fs.readFile(options.settings, 'utf8', (err, data) => {
            if (err) {
              return console.log(err);
            }

            const settings = JSON.parse(data);

            if(options.cube) {
                settings.filter = options.cube;
            }

            const olapValidator = new OLAPValidator(settings);
            olapValidator.run();
        });

    });

program.parse(process.argv);
